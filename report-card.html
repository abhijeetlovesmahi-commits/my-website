<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Official Academic Report</title>

<!-- jsPDF CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
@page{ size:A4; margin:15mm; }
body{
    background:#ccc;
    font-family:"Times New Roman", serif;
}
.page{
    width:210mm;
    min-height:297mm;
    background:white;
    margin:auto;
    padding:15mm;
    border:1px solid #000;
}
.header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    border-bottom:2px solid #000;
    padding-bottom:10px;
}
.logo{
    width:70px;
}
.school-name{
    text-align:center;
    flex:1;
}
.school-name h1{
    margin:0;
    font-size:26px;
    letter-spacing:1px;
}
.school-name p{
    margin:2px;
    font-size:14px;
}
.photo{
    width:90px;
    height:110px;
    border:1px solid #000;
}
.section{
    margin-top:12px;
}
table{
    width:100%;
    border-collapse:collapse;
    font-size:14px;
}
th,td{
    border:1px solid #000;
    padding:4px;
    text-align:center;
}
.info td{
    border:none;
    text-align:left;
    padding:3px;
}
input{
    border:none;
    border-bottom:1px solid #000;
    font-family:"Times New Roman";
    width:95%;
}
.footer{
    margin-top:20px;
    display:flex;
    justify-content:space-between;
}
.sign{
    width:30%;
    text-align:center;
}
.sign div{
    border-top:1px solid #000;
    margin-top:45px;
}
.controls{
    text-align:center;
    margin:15px;
}
@media print{
    body{background:white;}
    .controls{display:none;}
    input{border:none;}
}
</style>
</head>

<body>

<div class="controls">
<button onclick="generate()">Generate</button>
<button onclick="downloadPDF()">Download PDF</button>
</div>

<div class="page" id="report">

<div class="header">
<svg class="logo" viewBox="0 0 100 100">
<circle cx="50" cy="50" r="48" fill="#f4b400"/>
<text x="50" y="55" text-anchor="middle" font-size="40" fill="#000">L</text>
</svg>

<div class="school-name">
<h1>THE LALIT INTERNATIONAL SCHOOL</h1>
<p>ACADEMIC REPORT</p>
<p>Session: <input value="2022-2023"> | Class: <input value="I"></p>
</div>

<img id="photoShow" class="photo">
</div>

<div class="section">
<table class="info">
<tr>
<td>Name of Student:</td><td><input></td>
<td>Roll No:</td><td><input></td>
</tr>
<tr>
<td>Father's Name:</td><td><input></td>
<td>Date of Birth:</td><td><input></td>
</tr>
<tr>
<td>Mother's Name:</td><td><input></td>
<td>Admission No:</td><td><input></td>
</tr>
</table>
</div>

<div class="section">
<table>
<tr>
<th rowspan="2">Subject</th>
<th colspan="2">Term I</th>
<th colspan="2">Term II</th>
<th rowspan="2">Grand Total</th>
<th rowspan="2">Grade</th>
</tr>
<tr>
<th>Marks</th><th>Grade</th>
<th>Marks</th><th>Grade</th>
</tr>

<tr><td>English</td><td><input id="e1"></td><td id="eg1"></td><td><input id="e2"></td><td id="eg2"></td><td id="et"></td><td id="eg"></td></tr>
<tr><td>Hindi</td><td><input id="h1"></td><td id="hg1"></td><td><input id="h2"></td><td id="hg2"></td><td id="ht"></td><td id="hg"></td></tr>
<tr><td>Maths</td><td><input id="m1"></td><td id="mg1"></td><td><input id="m2"></td><td id="mg2"></td><td id="mt"></td><td id="mg"></td></tr>
<tr><td>Science</td><td><input id="s1"></td><td id="sg1"></td><td><input id="s2"></td><td id="sg2"></td><td id="st"></td><td id="sg"></td></tr>
</table>
</div>

<div class="footer">
<div class="sign"><div></div>Class Teacher</div>
<div class="sign"><div></div>Principal</div>
<div class="sign"><div></div>Guardian</div>
</div>

</div>

<script>
function grade(m){
 if(m>=91) return "A1";
 if(m>=81) return "A2";
 if(m>=71) return "B1";
 if(m>=61) return "B2";
 if(m>=51) return "C1";
 if(m>=41) return "C2";
 return "D";
}

function generate(){
["e","h","m","s"].forEach(x=>{
 let t1=+document.getElementById(x+"1").value||0;
 let t2=+document.getElementById(x+"2").value||0;
 document.getElementById(x+"g1").innerText=grade(t1);
 document.getElementById(x+"g2").innerText=grade(t2);
 let total=t1+t2;
 document.getElementById(x+"t").innerText=total;
 document.getElementById(x+"g").innerText=grade(total/2);
});
}

function downloadPDF(){
 html2canvas(document.getElementById("report")).then(canvas=>{
 const { jsPDF } = window.jspdf;
 let pdf=new jsPDF("p","mm","a4");
 pdf.addImage(canvas.toDataURL("image/png"),"PNG",0,0,210,297);
 pdf.save("ReportCard.pdf");
 });
}
</script>

</body>
</html>
